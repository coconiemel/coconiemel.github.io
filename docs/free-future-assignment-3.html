<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Free future assignment (3) | Portfolio</title>
  <meta name="description" content="Free future assignment (3) | Portfolio" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Free future assignment (3) | Portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Free future assignment (3) | Portfolio" />
  
  
  

<meta name="author" content="Coco Niemel" />


<meta name="date" content="2023-01-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-management-2.html"/>
<link rel="next" href="introduction-groupproject-5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Curriculum Vitae</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#education"><i class="fa fa-check"></i>Education</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#professional-experience"><i class="fa fa-check"></i>Professional Experience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#languages"><i class="fa fa-check"></i>Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html"><i class="fa fa-check"></i>Reproducible Research (1)</a>
<ul>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#the-analyzation-of-a-file"><i class="fa fa-check"></i>The analyzation of a file</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#scoring-reproducibility"><i class="fa fa-check"></i>Scoring reproducibility</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#usage-of-other-peoples-codes"><i class="fa fa-check"></i>Usage of other peoples codes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-management-2.html"><a href="data-management-2.html"><i class="fa fa-check"></i>Data management (2)</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html"><i class="fa fa-check"></i>Free future assignment (3)</a>
<ul>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#plan"><i class="fa fa-check"></i>Plan</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#the-phylogenetic-analysis"><i class="fa fa-check"></i>The phylogenetic analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html"><i class="fa fa-check"></i>Introduction groupproject (5)</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html#ontox"><i class="fa fa-check"></i>ONTOX</a></li>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html#our-addition"><i class="fa fa-check"></i>Our addition</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html"><i class="fa fa-check"></i>Relational data and databases (7)</a>
<ul>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#dbeaver-connection"><i class="fa fa-check"></i>DBeaver connection</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#inspection"><i class="fa fa-check"></i>Inspection</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive statistics</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#visualisations"><i class="fa fa-check"></i>Visualisations</a>
<ul>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#flu"><i class="fa fa-check"></i>Flu</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#dengue"><i class="fa fa-check"></i>Dengue</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html"><i class="fa fa-check"></i>R packages (8)</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html#introduction-3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html#copopa"><i class="fa fa-check"></i>Copopa</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown-parameters-9.html"><a href="rmarkdown-parameters-9.html"><i class="fa fa-check"></i>Rmarkdown parameters (9)</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="free-future-assignment-3" class="section level1 unnumbered hasAnchor">
<h1>Free future assignment (3)<a href="free-future-assignment-3.html#free-future-assignment-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="free-future-assignment-3.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After this course I will be specializing in microbiology, this is also where I see myself in a couple of years. Data science for me is a great opportunity to combine different work areas and keep my work various, but my main focus will be microbiology. Before i start working in the field, I hope to earn a masters degree, so in two years i will probably be busy with my masters.</p>
<p>Because I am interested in microbiology, my free assignment will also be in that lane. I will be learning to perform a phylogenetic analysis to a COVID dataset in R.</p>
</div>
<div id="plan" class="section level2 unnumbered hasAnchor">
<h2>Plan<a href="free-future-assignment-3.html#plan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
To achieve my goal, I have planned 4 days total to work on it. I have divided the days in a couple groups:
<ul>
<li>
Half a day to come up with a plan, write this and search the right data needed.
</li>
<li>
One day to follow a tutorial and find everything that I need for my own analysis.
</li>
<li>
Two days to implement this tutorial on the data i will be using and complete the analysis.
</li>
<li>
Half a day to finish the writing and details.
</li>
</ul>
</div>
<div id="the-phylogenetic-analysis" class="section level2 unnumbered hasAnchor">
<h2>The phylogenetic analysis<a href="free-future-assignment-3.html#the-phylogenetic-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="free-future-assignment-3.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adegenet)</span>
<span id="cb29-2"><a href="free-future-assignment-3.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span>
<span id="cb29-3"><a href="free-future-assignment-3.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(msa)</span>
<span id="cb29-4"><a href="free-future-assignment-3.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copopa)</span>
<span id="cb29-5"><a href="free-future-assignment-3.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb29-6"><a href="free-future-assignment-3.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span></code></pre></div>
<p>The code needs two functions from the {compbio4all} package, but Nathan L Brouwer, the writer of the package, states that if there is any trouble downloading the package the (following) codes for the function can be copied. The package in question can be found at <a href="https://github.com/brouwern/compbio4all.git">the github repository</a>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="free-future-assignment-3.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to clean up fasta files</span></span>
<span id="cb30-2"><a href="free-future-assignment-3.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="free-future-assignment-3.html#cb30-3" aria-hidden="true" tabindex="-1"></a>fasta_cleaner <span class="ot">&lt;-</span> <span class="cf">function</span>(fasta_object, <span class="at">parse =</span> <span class="cn">TRUE</span>){</span>
<span id="cb30-4"><a href="free-future-assignment-3.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="free-future-assignment-3.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  fasta_object <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;^(&gt;)(.*?)(</span><span class="sc">\\</span><span class="st">n)(.*)(</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">n)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">4&quot;</span>,fasta_object)</span>
<span id="cb30-6"><a href="free-future-assignment-3.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  fasta_object <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>, fasta_object)</span>
<span id="cb30-7"><a href="free-future-assignment-3.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="free-future-assignment-3.html#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(parse <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb30-9"><a href="free-future-assignment-3.html#cb30-9" aria-hidden="true" tabindex="-1"></a>    fasta_object <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_split</span>(fasta_object,</span>
<span id="cb30-10"><a href="free-future-assignment-3.html#cb30-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">pattern =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb30-11"><a href="free-future-assignment-3.html#cb30-11" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-12"><a href="free-future-assignment-3.html#cb30-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-13"><a href="free-future-assignment-3.html#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="free-future-assignment-3.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fasta_object[[<span class="dv">1</span>]])</span>
<span id="cb30-15"><a href="free-future-assignment-3.html#cb30-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-16"><a href="free-future-assignment-3.html#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="free-future-assignment-3.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to store fasta sequences into a R list</span></span>
<span id="cb30-18"><a href="free-future-assignment-3.html#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="free-future-assignment-3.html#cb30-19" aria-hidden="true" tabindex="-1"></a>entrez_fetch_list <span class="ot">&lt;-</span> <span class="cf">function</span>(db, id, rettype, ...){</span>
<span id="cb30-20"><a href="free-future-assignment-3.html#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="free-future-assignment-3.html#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setup list for storing output</span></span>
<span id="cb30-22"><a href="free-future-assignment-3.html#cb30-22" aria-hidden="true" tabindex="-1"></a>  n.seq <span class="ot">&lt;-</span> <span class="fu">length</span>(id)</span>
<span id="cb30-23"><a href="free-future-assignment-3.html#cb30-23" aria-hidden="true" tabindex="-1"></a>  list.output <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, n.seq))</span>
<span id="cb30-24"><a href="free-future-assignment-3.html#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(list.output) <span class="ot">&lt;-</span> id</span>
<span id="cb30-25"><a href="free-future-assignment-3.html#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="free-future-assignment-3.html#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get output</span></span>
<span id="cb30-27"><a href="free-future-assignment-3.html#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(id)){</span>
<span id="cb30-28"><a href="free-future-assignment-3.html#cb30-28" aria-hidden="true" tabindex="-1"></a>    list.output[[i]] <span class="ot">&lt;-</span> rentrez<span class="sc">::</span><span class="fu">entrez_fetch</span>(<span class="at">db =</span> db,</span>
<span id="cb30-29"><a href="free-future-assignment-3.html#cb30-29" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">id =</span> id[i],</span>
<span id="cb30-30"><a href="free-future-assignment-3.html#cb30-30" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rettype =</span> rettype)</span>
<span id="cb30-31"><a href="free-future-assignment-3.html#cb30-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-32"><a href="free-future-assignment-3.html#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="free-future-assignment-3.html#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="free-future-assignment-3.html#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(list.output)</span>
<span id="cb30-35"><a href="free-future-assignment-3.html#cb30-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The analysis starts by fetching the sequences from NCBI and make them compatible for analysis.
The file “species” is written to enhance the target IDs, this way, all the genomes can be fetched at once.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="free-future-assignment-3.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import list of target species</span></span>
<span id="cb31-2"><a href="free-future-assignment-3.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="free-future-assignment-3.html#cb31-3" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span><span class="fu">scan</span>(<span class="at">file =</span> (<span class="st">&quot;files/ebola_data/species.txt&quot;</span>), <span class="at">what =</span> <span class="st">&quot;character&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">comment.char =</span> <span class="st">&quot;#&quot;</span>) </span>
<span id="cb31-4"><a href="free-future-assignment-3.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="free-future-assignment-3.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain fasta sequences of all species combined in a list</span></span>
<span id="cb31-6"><a href="free-future-assignment-3.html#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="free-future-assignment-3.html#cb31-7" aria-hidden="true" tabindex="-1"></a>ebola_viruses <span class="ot">&lt;-</span> <span class="fu">entrez_fetch_list</span>(<span class="at">db =</span> <span class="st">&quot;nucleotide&quot;</span>,</span>
<span id="cb31-8"><a href="free-future-assignment-3.html#cb31-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> species,</span>
<span id="cb31-9"><a href="free-future-assignment-3.html#cb31-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">rettype =</span> <span class="st">&quot;fasta&quot;</span>) </span>
<span id="cb31-10"><a href="free-future-assignment-3.html#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="free-future-assignment-3.html#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non sequence infromation</span></span>
<span id="cb31-12"><a href="free-future-assignment-3.html#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="free-future-assignment-3.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ebola_viruses)){</span>
<span id="cb31-14"><a href="free-future-assignment-3.html#cb31-14" aria-hidden="true" tabindex="-1"></a>  ebola_viruses[[i]] <span class="ot">&lt;-</span> <span class="fu">fasta_cleaner</span>(ebola_viruses[[i]], <span class="at">parse =</span> F)</span>
<span id="cb31-15"><a href="free-future-assignment-3.html#cb31-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-16"><a href="free-future-assignment-3.html#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="free-future-assignment-3.html#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create string set</span></span>
<span id="cb31-18"><a href="free-future-assignment-3.html#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="free-future-assignment-3.html#cb31-19" aria-hidden="true" tabindex="-1"></a>ebola_vector <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(ebola_viruses))</span>
<span id="cb31-20"><a href="free-future-assignment-3.html#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="free-future-assignment-3.html#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ebola_vector)){</span>
<span id="cb31-22"><a href="free-future-assignment-3.html#cb31-22" aria-hidden="true" tabindex="-1"></a>  ebola_vector[i] <span class="ot">&lt;-</span> ebola_viruses[[i]]</span>
<span id="cb31-23"><a href="free-future-assignment-3.html#cb31-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-24"><a href="free-future-assignment-3.html#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="free-future-assignment-3.html#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ebola_vector) <span class="ot">&lt;-</span> <span class="fu">names</span>(ebola_viruses)</span>
<span id="cb31-26"><a href="free-future-assignment-3.html#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="free-future-assignment-3.html#cb31-27" aria-hidden="true" tabindex="-1"></a>ebola_vector_ss <span class="ot">&lt;-</span> Biostrings<span class="sc">::</span><span class="fu">AAStringSet</span>(ebola_vector)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="free-future-assignment-3.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple sequence alignment</span></span>
<span id="cb32-2"><a href="free-future-assignment-3.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="free-future-assignment-3.html#cb32-3" aria-hidden="true" tabindex="-1"></a>ebola_align <span class="ot">&lt;-</span> <span class="fu">msa</span>(ebola_vector_ss,</span>
<span id="cb32-4"><a href="free-future-assignment-3.html#cb32-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;ClustalW&quot;</span>)</span>
<span id="cb32-5"><a href="free-future-assignment-3.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="free-future-assignment-3.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Change class into correct one, in this case RNA because Ebola is a RNA-virus</span></span>
<span id="cb32-7"><a href="free-future-assignment-3.html#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="free-future-assignment-3.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ebola_align) <span class="ot">&lt;-</span> <span class="st">&quot;RNAMultipleAlignment&quot;</span></span>
<span id="cb32-9"><a href="free-future-assignment-3.html#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="free-future-assignment-3.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Save in file so alignment only needs to run once</span></span>
<span id="cb32-11"><a href="free-future-assignment-3.html#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="free-future-assignment-3.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ebola_align, (<span class="st">&quot;files/ebola_data/ebola_align.RDS&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="free-future-assignment-3.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import aligned file for usage</span></span>
<span id="cb33-2"><a href="free-future-assignment-3.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="free-future-assignment-3.html#cb33-3" aria-hidden="true" tabindex="-1"></a>ebola_align <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;files/ebola_data/ebola_align.RDS&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="free-future-assignment-3.html#cb34-1" aria-hidden="true" tabindex="-1"></a>ebola_align_seqinr <span class="ot">&lt;-</span> <span class="fu">msaConvert</span>(ebola_align, </span>
<span id="cb34-2"><a href="free-future-assignment-3.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="st">&quot;seqinr::alignment&quot;</span>)</span>
<span id="cb34-3"><a href="free-future-assignment-3.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="free-future-assignment-3.html#cb34-4" aria-hidden="true" tabindex="-1"></a>ebola_dist <span class="ot">&lt;-</span> seqinr<span class="sc">::</span><span class="fu">dist.alignment</span>(ebola_align_seqinr, </span>
<span id="cb34-5"><a href="free-future-assignment-3.html#cb34-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">matrix =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb34-6"><a href="free-future-assignment-3.html#cb34-6" aria-hidden="true" tabindex="-1"></a>ebola_dist_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(ebola_dist,</span>
<span id="cb34-7"><a href="free-future-assignment-3.html#cb34-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="free-future-assignment-3.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the structure of the tree</span></span>
<span id="cb35-2"><a href="free-future-assignment-3.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="free-future-assignment-3.html#cb35-3" aria-hidden="true" tabindex="-1"></a>ebola_tree <span class="ot">&lt;-</span> <span class="fu">nj</span>(ebola_dist)</span>
<span id="cb35-4"><a href="free-future-assignment-3.html#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="free-future-assignment-3.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot tree</span></span>
<span id="cb35-6"><a href="free-future-assignment-3.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="free-future-assignment-3.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.phylo</span>(ebola_tree, <span class="at">main=</span><span class="st">&quot;Phylogenetic Tree&quot;</span>, </span>
<span id="cb35-8"><a href="free-future-assignment-3.html#cb35-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">use.edge.length =</span> T)</span>
<span id="cb35-9"><a href="free-future-assignment-3.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add label</span></span>
<span id="cb35-10"><a href="free-future-assignment-3.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Ebola family gene tree - rooted, with branch lenths&quot;</span>)</span></code></pre></div>
<p><img src="portfolio_book_files/figure-html/phylogenetic%20tree-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="free-future-assignment-3.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(ebola_dist_rounded)</span></code></pre></div>
<pre><code>## [1] 0.6</code></pre>
<p>To do:
- Add normal lables to tree/msa
- Documentation
- Analysis after (closest relative etc.)
- Update plan and intro</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-management-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-groupproject-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
