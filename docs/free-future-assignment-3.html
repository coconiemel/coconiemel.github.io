<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Free future assignment (3) | Portfolio</title>
  <meta name="description" content="Free future assignment (3) | Portfolio" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Free future assignment (3) | Portfolio" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Free future assignment (3) | Portfolio" />
  
  
  

<meta name="author" content="Coco Niemel" />


<meta name="date" content="2023-01-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-management-2.html"/>
<link rel="next" href="introduction-groupproject-5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Curriculum Vitae</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#education"><i class="fa fa-check"></i>Education</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#professional-experience"><i class="fa fa-check"></i>Professional Experience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#skills"><i class="fa fa-check"></i>Skills</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#languages"><i class="fa fa-check"></i>Languages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html"><i class="fa fa-check"></i>Reproducible Research (1)</a>
<ul>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#the-analyzation-of-a-file"><i class="fa fa-check"></i>The analyzation of a file</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#scoring-reproducibility"><i class="fa fa-check"></i>Scoring reproducibility</a></li>
<li class="chapter" data-level="" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#usage-of-other-peoples-codes"><i class="fa fa-check"></i>Usage of other peoples codes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-management-2.html"><a href="data-management-2.html"><i class="fa fa-check"></i>Data management (2)</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html"><i class="fa fa-check"></i>Free future assignment (3)</a>
<ul>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#plan"><i class="fa fa-check"></i>Plan</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#the-filoviridae-family"><i class="fa fa-check"></i>The Filoviridae family</a></li>
<li class="chapter" data-level="" data-path="free-future-assignment-3.html"><a href="free-future-assignment-3.html#the-phylogenetic-tree"><i class="fa fa-check"></i>The phylogenetic tree</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html"><i class="fa fa-check"></i>Introduction groupproject (5)</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html#ontox"><i class="fa fa-check"></i>ONTOX</a></li>
<li class="chapter" data-level="" data-path="introduction-groupproject-5.html"><a href="introduction-groupproject-5.html#our-addition"><i class="fa fa-check"></i>Our addition</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html"><i class="fa fa-check"></i>Relational data and databases (7)</a>
<ul>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#dbeaver-connection"><i class="fa fa-check"></i>DBeaver connection</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#inspection"><i class="fa fa-check"></i>Inspection</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive statistics</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#visualisations"><i class="fa fa-check"></i>Visualisations</a>
<ul>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#flu"><i class="fa fa-check"></i>Flu</a></li>
<li class="chapter" data-level="" data-path="relational-data-and-databases-7.html"><a href="relational-data-and-databases-7.html#dengue"><i class="fa fa-check"></i>Dengue</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html"><i class="fa fa-check"></i>R packages (8)</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html#introduction-3"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-8.html"><a href="r-packages-8.html#copopa"><i class="fa fa-check"></i>Copopa</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown-parameters-9.html"><a href="rmarkdown-parameters-9.html"><i class="fa fa-check"></i>Rmarkdown parameters (9)</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="free-future-assignment-3" class="section level1 unnumbered hasAnchor">
<h1>Free future assignment (3)<a href="free-future-assignment-3.html#free-future-assignment-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 unnumbered hasAnchor">
<h2>Introduction<a href="free-future-assignment-3.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this assignment, we were opted to learn a new skill in four days, any skill related to data science and life sciences that will help you in the future.</p>
<p>After this course I will be specializing in microbiology, this is also where I see myself in a couple of years. Data science for me is a great opportunity to combine different work areas and keep my work various, but my main focus will be microbiology. Before i start working in the field, I hope to earn a masters degree, so in two years i will probably be busy with my masters. I am not sure what masters I would like to do.</p>
<p>Because I am interested in microbiology, my free assignment will also be in that lane. I chose to learn to generate a phylogenetic tree about the Filoviridae family. I chose this viral family because I am interested in infectious diseases and two species of these are known to cause quite the infectious diseases.</p>
</div>
<div id="plan" class="section level2 unnumbered hasAnchor">
<h2>Plan<a href="free-future-assignment-3.html#plan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
To achieve my goal, I had 4 days total planned to work on it. I had divided the days in a couple groups:
<ul>
<li>
Half a day to come up with a plan, write this and search the right data needed.
</li>
<li>
One day to follow a tutorial and find everything that I need for my own analysis.
</li>
<li>
Two days to implement my knowledge from searching the internet and the tutorial to the data I will be using and complete generating the tree.
</li>
<li>
Half a day to finish the writing and details.
</li>
</ul>
Eventually, i gained my needed information to generate a phylogenetic tree from a little trial and error, but mostly because of the following resources:
<ul>
<li>
<a href="https://bioconductor.org/packages/devel/bioc/vignettes/Biostrings/inst/doc/MultipleAlignments.pdf">Multiple Alignment Object</a>
</li>
<li>
<a href="https://bioconductor.statistik.tu-dortmund.de/packages/3.5/bioc/vignettes/ggtree/inst/doc/ggtreeUtilities.html">ggtree utilities</a>
</li>
<li>
<a href="https://bioconductor.statistik.tu-dortmund.de/packages/3.8/bioc/vignettes/ggtree/inst/doc/treeVisualization.html#displaying-tree-scale-evolution-distance">tree Visualization</a>
</li>
<li>
<a href="https://brouwern.github.io/lbrb/worked-example-building-a-phylogeny-in-r.html#genetic-distances-of-sequence-in-subset">Building a phylogeny in R</a>
</li>
<li>
<a href="https://guangchuangyu.github.io/ggtree-book/chapter-ggtree.html">Visualization and annotation of phylogenetic trees: ggtree</a>
</li>
</ul>
</div>
<div id="the-filoviridae-family" class="section level2 unnumbered hasAnchor">
<h2>The Filoviridae family<a href="free-future-assignment-3.html#the-filoviridae-family" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Viruses of the Filoviridae family, also know as filoviruses, are viruses containing one molecule of single-stranded negative-sense RNA that are enveloped in a fatty membrane. The viruses are zoonotic and it is believed that their reservoir hosts usually are bats <span class="citation">(<a href="#ref-FilovirusesFiloviridaeViral2021" role="doc-biblioref"><span>“Filoviruses (<span>Filoviridae</span>) | <span>Viral Hemorrhagic Fevers</span> (<span>VHFs</span>) | <span>CDC</span>”</span> 2021</a>)</span>. The viruses are one of the families known to cause Viral hemorrhagic fevers (VHS) that affects multiple body systems and usually results in heavy bleeding and death <span class="citation">(<a href="#ref-WhatAreVHFs2021" role="doc-biblioref"><span>“What Are <span>VHFs</span>? | <span>Viral Hemorrhagic Fevers</span> (<span>VHFs</span>) | <span>CDC</span>”</span> 2021</a>)</span>.</p>
<p>There are currently five genera in the family; Ebolavirus, Marburgvirus, Cuevavirus, Dianlovirus and Striavirus. Ebolavirus has six knows species and the rest have one <span class="citation">(<a href="#ref-languonFilovirusDiseaseOutbreaks2019" role="doc-biblioref">Languon and Quaye 2019</a>)</span>. In my analysis I left Striavirus out, because there is barely any information or data about Striavirus.</p>
<p>Ebolavirus and Marburgvirus are the most common to cause (deathly) disease in humans, the other ones also host in non-human primates and pigs <span class="citation">(<a href="#ref-filoviruses-infection-with.pdf" role="doc-biblioref"><strong>filoviruses-infection-with.pdf?</strong></a>)</span>.</p>
</div>
<div id="the-phylogenetic-tree" class="section level2 unnumbered hasAnchor">
<h2>The phylogenetic tree<a href="free-future-assignment-3.html#the-phylogenetic-tree" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The code needs two functions from the {compbio4all} package, but Nathan L Brouwer, the writer of the package, states that if there is any trouble downloading the package the (following) codes for the function can be copied. The package in question can be found at <a href="https://github.com/brouwern/compbio4all.git">the github repository</a>. I did have trouble installing the packages, so the code retrieved from github is below.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="free-future-assignment-3.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to clean up fasta files</span></span>
<span id="cb29-2"><a href="free-future-assignment-3.html#cb29-2" aria-hidden="true" tabindex="-1"></a>fasta_cleaner <span class="ot">&lt;-</span> <span class="cf">function</span>(fasta_object, <span class="at">parse =</span> <span class="cn">TRUE</span>){</span>
<span id="cb29-3"><a href="free-future-assignment-3.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="free-future-assignment-3.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  fasta_object <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;^(&gt;)(.*?)(</span><span class="sc">\\</span><span class="st">n)(.*)(</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">n)&quot;</span>,<span class="st">&quot;</span><span class="sc">\\</span><span class="st">4&quot;</span>,fasta_object)</span>
<span id="cb29-5"><a href="free-future-assignment-3.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  fasta_object <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>, fasta_object)</span>
<span id="cb29-6"><a href="free-future-assignment-3.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="free-future-assignment-3.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(parse <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb29-8"><a href="free-future-assignment-3.html#cb29-8" aria-hidden="true" tabindex="-1"></a>    fasta_object <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_split</span>(fasta_object,</span>
<span id="cb29-9"><a href="free-future-assignment-3.html#cb29-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">pattern =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb29-10"><a href="free-future-assignment-3.html#cb29-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-11"><a href="free-future-assignment-3.html#cb29-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-12"><a href="free-future-assignment-3.html#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="free-future-assignment-3.html#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fasta_object[[<span class="dv">1</span>]])</span>
<span id="cb29-14"><a href="free-future-assignment-3.html#cb29-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-15"><a href="free-future-assignment-3.html#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="free-future-assignment-3.html#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to store fasta sequences into a R list</span></span>
<span id="cb29-17"><a href="free-future-assignment-3.html#cb29-17" aria-hidden="true" tabindex="-1"></a>entrez_fetch_list <span class="ot">&lt;-</span> <span class="cf">function</span>(db, id, rettype, ...){</span>
<span id="cb29-18"><a href="free-future-assignment-3.html#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="free-future-assignment-3.html#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#setup list for storing output</span></span>
<span id="cb29-20"><a href="free-future-assignment-3.html#cb29-20" aria-hidden="true" tabindex="-1"></a>  n.seq <span class="ot">&lt;-</span> <span class="fu">length</span>(id)</span>
<span id="cb29-21"><a href="free-future-assignment-3.html#cb29-21" aria-hidden="true" tabindex="-1"></a>  list.output <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, n.seq))</span>
<span id="cb29-22"><a href="free-future-assignment-3.html#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(list.output) <span class="ot">&lt;-</span> id</span>
<span id="cb29-23"><a href="free-future-assignment-3.html#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="free-future-assignment-3.html#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get output</span></span>
<span id="cb29-25"><a href="free-future-assignment-3.html#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(id)){</span>
<span id="cb29-26"><a href="free-future-assignment-3.html#cb29-26" aria-hidden="true" tabindex="-1"></a>    list.output[[i]] <span class="ot">&lt;-</span> rentrez<span class="sc">::</span><span class="fu">entrez_fetch</span>(<span class="at">db =</span> db,</span>
<span id="cb29-27"><a href="free-future-assignment-3.html#cb29-27" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">id =</span> id[i],</span>
<span id="cb29-28"><a href="free-future-assignment-3.html#cb29-28" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">rettype =</span> rettype)</span>
<span id="cb29-29"><a href="free-future-assignment-3.html#cb29-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-30"><a href="free-future-assignment-3.html#cb29-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-31"><a href="free-future-assignment-3.html#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="free-future-assignment-3.html#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(list.output)</span>
<span id="cb29-33"><a href="free-future-assignment-3.html#cb29-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The analysis starts by fetching the sequences from NCBI <span class="citation">(<a href="#ref-NationalCenterBiotechnology" role="doc-biblioref"><span>“National <span>Center</span> for <span>Biotechnology Information</span>,”</span> n.d.</a>)</span> and make them compatible for analysis.
The file “species” is written to enhance the target IDs, this way, all the genomes can be fetched at once.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="free-future-assignment-3.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import list of target species</span></span>
<span id="cb30-2"><a href="free-future-assignment-3.html#cb30-2" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span><span class="fu">scan</span>(<span class="at">file =</span> (<span class="st">&quot;files/filo_data/species.txt&quot;</span>), <span class="at">what =</span> <span class="st">&quot;character&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">comment.char =</span> <span class="st">&quot;#&quot;</span>) </span>
<span id="cb30-3"><a href="free-future-assignment-3.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="free-future-assignment-3.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain fasta sequences of all species combined in a list</span></span>
<span id="cb30-5"><a href="free-future-assignment-3.html#cb30-5" aria-hidden="true" tabindex="-1"></a>filoviridae <span class="ot">&lt;-</span> <span class="fu">entrez_fetch_list</span>(<span class="at">db =</span> <span class="st">&quot;nucleotide&quot;</span>,</span>
<span id="cb30-6"><a href="free-future-assignment-3.html#cb30-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> species,</span>
<span id="cb30-7"><a href="free-future-assignment-3.html#cb30-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">rettype =</span> <span class="st">&quot;fasta&quot;</span>) </span>
<span id="cb30-8"><a href="free-future-assignment-3.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="free-future-assignment-3.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non sequence infromation</span></span>
<span id="cb30-10"><a href="free-future-assignment-3.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(filoviridae)){</span>
<span id="cb30-11"><a href="free-future-assignment-3.html#cb30-11" aria-hidden="true" tabindex="-1"></a>  filoviridae[[i]] <span class="ot">&lt;-</span> <span class="fu">fasta_cleaner</span>(filoviridae[[i]], <span class="at">parse =</span> F)</span>
<span id="cb30-12"><a href="free-future-assignment-3.html#cb30-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-13"><a href="free-future-assignment-3.html#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="free-future-assignment-3.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create string set</span></span>
<span id="cb30-15"><a href="free-future-assignment-3.html#cb30-15" aria-hidden="true" tabindex="-1"></a>filoviridae_vector <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(filoviridae))</span>
<span id="cb30-16"><a href="free-future-assignment-3.html#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="free-future-assignment-3.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(filoviridae_vector)){</span>
<span id="cb30-18"><a href="free-future-assignment-3.html#cb30-18" aria-hidden="true" tabindex="-1"></a>  filoviridae_vector[i] <span class="ot">&lt;-</span> filoviridae[[i]]</span>
<span id="cb30-19"><a href="free-future-assignment-3.html#cb30-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-20"><a href="free-future-assignment-3.html#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="free-future-assignment-3.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(filoviridae_vector) <span class="ot">&lt;-</span> <span class="fu">names</span>(filoviridae)</span>
<span id="cb30-22"><a href="free-future-assignment-3.html#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="free-future-assignment-3.html#cb30-23" aria-hidden="true" tabindex="-1"></a>filoviridae_vector_ss <span class="ot">&lt;-</span> Biostrings<span class="sc">::</span><span class="fu">AAStringSet</span>(filoviridae_vector)</span></code></pre></div>
<p>Next is the multiple sequence alignment. This creates an alignment to easily spot the distances between all the options. Because this takes a long time to perform, I saved the alignment in a file that can be obtained.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="free-future-assignment-3.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform multiple sequence alignment</span></span>
<span id="cb31-2"><a href="free-future-assignment-3.html#cb31-2" aria-hidden="true" tabindex="-1"></a>filoviridae_align <span class="ot">&lt;-</span> <span class="fu">msa</span>(filoviridae_vector_ss,</span>
<span id="cb31-3"><a href="free-future-assignment-3.html#cb31-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;ClustalW&quot;</span>)</span>
<span id="cb31-4"><a href="free-future-assignment-3.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="free-future-assignment-3.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Change class into correct one, in this case RNA because Ebola is a RNA-virus</span></span>
<span id="cb31-6"><a href="free-future-assignment-3.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(filoviridae_align) <span class="ot">&lt;-</span> <span class="st">&quot;RNAMultipleAlignment&quot;</span></span>
<span id="cb31-7"><a href="free-future-assignment-3.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="free-future-assignment-3.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Save in file so alignment only needs to run once</span></span>
<span id="cb31-9"><a href="free-future-assignment-3.html#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(filoviridae_align, (<span class="st">&quot;files/filo_data/filoviridae_align.RDS&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="free-future-assignment-3.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import aligned file for usage</span></span>
<span id="cb32-2"><a href="free-future-assignment-3.html#cb32-2" aria-hidden="true" tabindex="-1"></a>filoviridae_align <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;files/filo_data/filoviridae_align.RDS&quot;</span>)</span></code></pre></div>
<p>To use the alignment for the tree, the genetic distance between the sequences will be calculated. For readability, a rounded version is also made. After the calculations the tree is plotted. The tree clearly shows that most ebolaviruses are closely related, which is logical because they are only different species, only Reston and Sudan are somewhat further from the rest but close to each other. Is also shows that Mengla dianlovirus and Marburg marburgvirus are closely related, and Lloviu is also nearby.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="free-future-assignment-3.html#cb33-1" aria-hidden="true" tabindex="-1"></a>filoviridae_align_seqinr <span class="ot">&lt;-</span> <span class="fu">msaConvert</span>(filoviridae_align, </span>
<span id="cb33-2"><a href="free-future-assignment-3.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="st">&quot;seqinr::alignment&quot;</span>)</span>
<span id="cb33-3"><a href="free-future-assignment-3.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="free-future-assignment-3.html#cb33-4" aria-hidden="true" tabindex="-1"></a>filoviridae_dist <span class="ot">&lt;-</span> seqinr<span class="sc">::</span><span class="fu">dist.alignment</span>(filoviridae_align_seqinr, </span>
<span id="cb33-5"><a href="free-future-assignment-3.html#cb33-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">matrix =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb33-6"><a href="free-future-assignment-3.html#cb33-6" aria-hidden="true" tabindex="-1"></a>filoviridae_dist_rounded <span class="ot">&lt;-</span> <span class="fu">round</span>(filoviridae_dist,</span>
<span id="cb33-7"><a href="free-future-assignment-3.html#cb33-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="free-future-assignment-3.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the structure of the tree</span></span>
<span id="cb34-2"><a href="free-future-assignment-3.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="free-future-assignment-3.html#cb34-3" aria-hidden="true" tabindex="-1"></a>filoviridae_tree <span class="ot">&lt;-</span> <span class="fu">nj</span>(filoviridae_dist)</span>
<span id="cb34-4"><a href="free-future-assignment-3.html#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="free-future-assignment-3.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tree</span></span>
<span id="cb34-6"><a href="free-future-assignment-3.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="free-future-assignment-3.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>(filoviridae_tree, <span class="at">ladderize =</span> T, <span class="at">branch.length =</span> <span class="st">&quot;branch.length&quot;</span>, </span>
<span id="cb34-8"><a href="free-future-assignment-3.html#cb34-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">root.position =</span> .<span class="dv">05</span>)<span class="sc">+</span> </span>
<span id="cb34-9"><a href="free-future-assignment-3.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tiplab</span>(<span class="at">size =</span> <span class="fl">3.5</span>)<span class="sc">+</span></span>
<span id="cb34-10"><a href="free-future-assignment-3.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, .<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb34-11"><a href="free-future-assignment-3.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Filoviridae family tree&quot;</span>,  </span>
<span id="cb34-12"><a href="free-future-assignment-3.html#cb34-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Rooted phylogenetic tree, with branch lengths&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-13"><a href="free-future-assignment-3.html#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="at">hjust =</span> .<span class="dv">5</span>))</span></code></pre></div>
<p><img src="portfolio_book_files/figure-html/phylogenetic%20tree-1.png" width="672" /></p>
<p><em>Figure 2: Phylogenetic tree of the Filoviridae family.</em></p>
<p>The tree shows an easy picture of the differences, but is doesn’t show the numbers in detail. To solve this, I calcutated them separately.</p>
<p>The return of the code below shows the calculated genetic distances of all options. Seen from here is states that Taiforest ebolavirus &amp; Bundibogyo ebolavirus are closest related with a score of 0.56.</p>
<p>It also states that there are multiple options that score furthest related with a score of 0.76. These are: Bombali ebolavirus &amp; Marburg marburgvirus, Bombali ebolavirus &amp; Mengla dianlovirus, Sudan ebolavirus &amp; Marburg marburgvirus, Sudan ebolavirus &amp; Mengla dianlovirus, Reston ebolavirus &amp; Marburg marburgvirus, Lloviu cuevavirus &amp; Marburg marburgvirus, Lloviu cuevavirus &amp; Mengla dianlovirus.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="free-future-assignment-3.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Details</span></span>
<span id="cb35-2"><a href="free-future-assignment-3.html#cb35-2" aria-hidden="true" tabindex="-1"></a>filoviridae_dist_rounded</span></code></pre></div>
<pre><code>##                                 KC545393.1 Bundibogyo ebolavirus
## MH121167.1 Taiforest ebolavirus                             0.56
## KT357858.1 Zaire ebolavirus                                 0.61
## NC_039345.1 Bombali ebolavirus                              0.64
## EU338380.1 Sudan ebolavirus                                 0.65
## MF540571.1 Reston ebolavirus                                0.65
## MZ541881.1 Lloviu cuevavirus                                0.70
## OL702894.1 Marburg marburgvirus                             0.75
## NC_055510.1 Mengla dianlovirus                              0.75
##                                 MH121167.1 Taiforest ebolavirus
## MH121167.1 Taiforest ebolavirus                                
## KT357858.1 Zaire ebolavirus                                0.61
## NC_039345.1 Bombali ebolavirus                             0.64
## EU338380.1 Sudan ebolavirus                                0.65
## MF540571.1 Reston ebolavirus                               0.65
## MZ541881.1 Lloviu cuevavirus                               0.70
## OL702894.1 Marburg marburgvirus                            0.76
## NC_055510.1 Mengla dianlovirus                             0.75
##                                 KT357858.1 Zaire ebolavirus
## MH121167.1 Taiforest ebolavirus                            
## KT357858.1 Zaire ebolavirus                                
## NC_039345.1 Bombali ebolavirus                         0.63
## EU338380.1 Sudan ebolavirus                            0.65
## MF540571.1 Reston ebolavirus                           0.65
## MZ541881.1 Lloviu cuevavirus                           0.71
## OL702894.1 Marburg marburgvirus                        0.75
## NC_055510.1 Mengla dianlovirus                         0.75
##                                 NC_039345.1 Bombali ebolavirus
## MH121167.1 Taiforest ebolavirus                               
## KT357858.1 Zaire ebolavirus                                   
## NC_039345.1 Bombali ebolavirus                                
## EU338380.1 Sudan ebolavirus                               0.66
## MF540571.1 Reston ebolavirus                              0.66
## MZ541881.1 Lloviu cuevavirus                              0.70
## OL702894.1 Marburg marburgvirus                           0.76
## NC_055510.1 Mengla dianlovirus                            0.76
##                                 EU338380.1 Sudan ebolavirus
## MH121167.1 Taiforest ebolavirus                            
## KT357858.1 Zaire ebolavirus                                
## NC_039345.1 Bombali ebolavirus                             
## EU338380.1 Sudan ebolavirus                                
## MF540571.1 Reston ebolavirus                           0.63
## MZ541881.1 Lloviu cuevavirus                           0.71
## OL702894.1 Marburg marburgvirus                        0.76
## NC_055510.1 Mengla dianlovirus                         0.76
##                                 MF540571.1 Reston ebolavirus
## MH121167.1 Taiforest ebolavirus                             
## KT357858.1 Zaire ebolavirus                                 
## NC_039345.1 Bombali ebolavirus                              
## EU338380.1 Sudan ebolavirus                                 
## MF540571.1 Reston ebolavirus                                
## MZ541881.1 Lloviu cuevavirus                            0.71
## OL702894.1 Marburg marburgvirus                         0.76
## NC_055510.1 Mengla dianlovirus                          0.75
##                                 MZ541881.1 Lloviu cuevavirus
## MH121167.1 Taiforest ebolavirus                             
## KT357858.1 Zaire ebolavirus                                 
## NC_039345.1 Bombali ebolavirus                              
## EU338380.1 Sudan ebolavirus                                 
## MF540571.1 Reston ebolavirus                                
## MZ541881.1 Lloviu cuevavirus                                
## OL702894.1 Marburg marburgvirus                         0.76
## NC_055510.1 Mengla dianlovirus                          0.76
##                                 OL702894.1 Marburg marburgvirus
## MH121167.1 Taiforest ebolavirus                                
## KT357858.1 Zaire ebolavirus                                    
## NC_039345.1 Bombali ebolavirus                                 
## EU338380.1 Sudan ebolavirus                                    
## MF540571.1 Reston ebolavirus                                   
## MZ541881.1 Lloviu cuevavirus                                   
## OL702894.1 Marburg marburgvirus                                
## NC_055510.1 Mengla dianlovirus                             0.67</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="free-future-assignment-3.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(filoviridae_dist_rounded) </span></code></pre></div>
<pre><code>## [1] 0.56</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="free-future-assignment-3.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(filoviridae_dist_rounded)</span></code></pre></div>
<pre><code>## [1] 0.76</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-FilovirusesFiloviridaeViral2021" class="csl-entry">
<span>“Filoviruses (<span>Filoviridae</span>) | <span>Viral Hemorrhagic Fevers</span> (<span>VHFs</span>) | <span>CDC</span>.”</span> 2021. https://www.cdc.gov/vhf/virus-families/filoviridae.html.
</div>
<div id="ref-languonFilovirusDiseaseOutbreaks2019" class="csl-entry">
Languon, Sylvester, and Osbourne Quaye. 2019. <span>“Filovirus <span>Disease Outbreaks</span>: <span>A Chronological Overview</span>.”</span> <em>Virology : Research and Treatment</em> 10 (June): 1178122X19849927. <a href="https://doi.org/10.1177/1178122X19849927">https://doi.org/10.1177/1178122X19849927</a>.
</div>
<div id="ref-NationalCenterBiotechnology" class="csl-entry">
<span>“National <span>Center</span> for <span>Biotechnology Information</span>.”</span> n.d. https://www.ncbi.nlm.nih.gov/.
</div>
<div id="ref-WhatAreVHFs2021" class="csl-entry">
<span>“What Are <span>VHFs</span>? | <span>Viral Hemorrhagic Fevers</span> (<span>VHFs</span>) | <span>CDC</span>.”</span> 2021. https://www.cdc.gov/vhf/about.html.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-management-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-groupproject-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
